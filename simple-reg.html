<!DOCTYPE html>
<html  lang="it">

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Elementi di R e Radiant per un primo corso di Statistica</title>
  <meta name="description" content="Breve manuale per l’apprendimento di alcuni elementi di R e Radiant. Materiale di supporto per il Corso 30001 (Statistica) dell’Università Bocconi.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Elementi di R e Radiant per un primo corso di Statistica" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Breve manuale per l’apprendimento di alcuni elementi di R e Radiant. Materiale di supporto per il Corso 30001 (Statistica) dell’Università Bocconi." />
  <meta name="github-repo" content="sergioventurini/manuale_R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Elementi di R e Radiant per un primo corso di Statistica" />
  
  <meta name="twitter:description" content="Breve manuale per l’apprendimento di alcuni elementi di R e Radiant. Materiale di supporto per il Corso 30001 (Statistica) dell’Università Bocconi." />
  



<meta name="date" content="2018-07-20">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="chapter5.html">
<link rel="next" href="il-modello-di-regressione-lineare-multipla.html">
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Elementi di <tt>R</tt> e <tt>Radiant</tt></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Premessa</a></li>
<li class="chapter" data-level="1" data-path="introduzione.html"><a href="introduzione.html"><i class="fa fa-check"></i><b>1</b> Introduzione</a><ul>
<li class="chapter" data-level="1.1" data-path="installazione-dei-software.html"><a href="installazione-dei-software.html"><i class="fa fa-check"></i><b>1.1</b> Installazione dei software</a><ul>
<li class="chapter" data-level="1.1.1" data-path="installazione-dei-software.html"><a href="installazione-dei-software.html#installazione-su-windows"><i class="fa fa-check"></i><b>1.1.1</b> Installazione su Windows</a></li>
<li class="chapter" data-level="1.1.2" data-path="installazione-dei-software.html"><a href="installazione-dei-software.html#installazione-su-mac"><i class="fa fa-check"></i><b>1.1.2</b> Installazione su Mac</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="lapproccio-al-calcolo-statistico-di-r.html"><a href="lapproccio-al-calcolo-statistico-di-r.html"><i class="fa fa-check"></i><b>1.2</b> L’approccio al calcolo statistico di <tt>R</tt></a></li>
<li class="chapter" data-level="1.3" data-path="le-principali-strutture-di-dati-disponibili-in-r.html"><a href="le-principali-strutture-di-dati-disponibili-in-r.html"><i class="fa fa-check"></i><b>1.3</b> Le principali strutture di dati disponibili in <tt>R</tt></a><ul>
<li class="chapter" data-level="1.3.1" data-path="le-principali-strutture-di-dati-disponibili-in-r.html"><a href="le-principali-strutture-di-dati-disponibili-in-r.html#tipi-di-dati-di-base"><i class="fa fa-check"></i><b>1.3.1</b> Tipi di dati di base</a></li>
<li class="chapter" data-level="1.3.2" data-path="le-principali-strutture-di-dati-disponibili-in-r.html"><a href="le-principali-strutture-di-dati-disponibili-in-r.html#vettori"><i class="fa fa-check"></i><b>1.3.2</b> Vettori</a></li>
<li class="chapter" data-level="1.3.3" data-path="le-principali-strutture-di-dati-disponibili-in-r.html"><a href="le-principali-strutture-di-dati-disponibili-in-r.html#matrix"><i class="fa fa-check"></i><b>1.3.3</b> Matrici</a></li>
<li class="chapter" data-level="1.3.4" data-path="le-principali-strutture-di-dati-disponibili-in-r.html"><a href="le-principali-strutture-di-dati-disponibili-in-r.html#factor-vector"><i class="fa fa-check"></i><b>1.3.4</b> Vettori factor</a></li>
<li class="chapter" data-level="1.3.5" data-path="le-principali-strutture-di-dati-disponibili-in-r.html"><a href="le-principali-strutture-di-dati-disponibili-in-r.html#data-frame"><i class="fa fa-check"></i><b>1.3.5</b> Data frame</a></li>
<li class="chapter" data-level="1.3.6" data-path="le-principali-strutture-di-dati-disponibili-in-r.html"><a href="le-principali-strutture-di-dati-disponibili-in-r.html#lists"><i class="fa fa-check"></i><b>1.3.6</b> Liste</a></li>
<li class="chapter" data-level="1.3.7" data-path="le-principali-strutture-di-dati-disponibili-in-r.html"><a href="le-principali-strutture-di-dati-disponibili-in-r.html#funzioni"><i class="fa fa-check"></i><b>1.3.7</b> Funzioni</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="howtogethelp.html"><a href="howtogethelp.html"><i class="fa fa-check"></i><b>1.4</b> Come reperire informazioni sui comandi di <tt>R</tt></a></li>
<li class="chapter" data-level="1.5" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>1.5</b> I pacchetti di <tt>R</tt></a></li>
<li class="chapter" data-level="1.6" data-path="lapplicazione-rstudio.html"><a href="lapplicazione-rstudio.html"><i class="fa fa-check"></i><b>1.6</b> L’applicazione <tt>RStudio</tt></a></li>
<li class="chapter" data-level="1.7" data-path="il-pacchetto-radiant.html"><a href="il-pacchetto-radiant.html"><i class="fa fa-check"></i><b>1.7</b> Il pacchetto <tt>Radiant</tt></a></li>
<li class="chapter" data-level="1.8" data-path="file-loading.html"><a href="file-loading.html"><i class="fa fa-check"></i><b>1.8</b> Come caricare e salvare un file in <tt>R</tt> e <tt>Radiant</tt></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="statistica-descrittiva.html"><a href="statistica-descrittiva.html"><i class="fa fa-check"></i><b>2</b> Statistica descrittiva</a><ul>
<li class="chapter" data-level="2.1" data-path="descriptive-R.html"><a href="descriptive-R.html"><i class="fa fa-check"></i><b>2.1</b> Primi esempi con <tt>R</tt></a></li>
<li class="chapter" data-level="2.2" data-path="analisi-descrittive-univariate.html"><a href="analisi-descrittive-univariate.html"><i class="fa fa-check"></i><b>2.2</b> Analisi descrittive univariate</a><ul>
<li class="chapter" data-level="2.2.1" data-path="analisi-descrittive-univariate.html"><a href="analisi-descrittive-univariate.html#una-singola-variabile-categorica"><i class="fa fa-check"></i><b>2.2.1</b> Una singola variabile categorica</a></li>
<li class="chapter" data-level="2.2.2" data-path="analisi-descrittive-univariate.html"><a href="analisi-descrittive-univariate.html#una-singola-variabile-numerica"><i class="fa fa-check"></i><b>2.2.2</b> Una singola variabile numerica</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="analisi-descrittive-bivariate.html"><a href="analisi-descrittive-bivariate.html"><i class="fa fa-check"></i><b>2.3</b> Analisi descrittive bivariate</a><ul>
<li class="chapter" data-level="2.3.1" data-path="analisi-descrittive-bivariate.html"><a href="analisi-descrittive-bivariate.html#due-variabili-categoriche"><i class="fa fa-check"></i><b>2.3.1</b> Due variabili categoriche</a></li>
<li class="chapter" data-level="2.3.2" data-path="analisi-descrittive-bivariate.html"><a href="analisi-descrittive-bivariate.html#lincorr"><i class="fa fa-check"></i><b>2.3.2</b> Due variabili numeriche</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="calcolo-delle-probabilita.html"><a href="calcolo-delle-probabilita.html"><i class="fa fa-check"></i><b>3</b> Calcolo delle probabilità</a><ul>
<li class="chapter" data-level="3.1" data-path="variabili-aleatorie-binomiali.html"><a href="variabili-aleatorie-binomiali.html"><i class="fa fa-check"></i><b>3.1</b> Variabili aleatorie binomiali</a></li>
<li class="chapter" data-level="3.2" data-path="variabili-aleatorie-normali-o-gaussiane.html"><a href="variabili-aleatorie-normali-o-gaussiane.html"><i class="fa fa-check"></i><b>3.2</b> Variabili aleatorie normali (o gaussiane)</a></li>
<li class="chapter" data-level="3.3" data-path="altre-variabili-aleatorie.html"><a href="altre-variabili-aleatorie.html"><i class="fa fa-check"></i><b>3.3</b> Altre variabili aleatorie</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="statistica-inferenziale.html"><a href="statistica-inferenziale.html"><i class="fa fa-check"></i><b>4</b> Statistica inferenziale</a><ul>
<li class="chapter" data-level="4.1" data-path="inferenza-sulla-media-di-una-popolazione-normale.html"><a href="inferenza-sulla-media-di-una-popolazione-normale.html"><i class="fa fa-check"></i><b>4.1</b> Inferenza sulla media di una popolazione normale</a></li>
<li class="chapter" data-level="4.2" data-path="inferenza-sulla-proporzione-di-successi-in-una-popolazione-bernoulliana.html"><a href="inferenza-sulla-proporzione-di-successi-in-una-popolazione-bernoulliana.html"><i class="fa fa-check"></i><b>4.2</b> Inferenza sulla proporzione di successi in una popolazione bernoulliana</a></li>
<li class="chapter" data-level="4.3" data-path="inferenza-sul-confronto-tra-le-medie-di-due-popolazioni-normali.html"><a href="inferenza-sul-confronto-tra-le-medie-di-due-popolazioni-normali.html"><i class="fa fa-check"></i><b>4.3</b> Inferenza sul confronto tra le medie di due popolazioni normali</a><ul>
<li class="chapter" data-level="4.3.1" data-path="inferenza-sul-confronto-tra-le-medie-di-due-popolazioni-normali.html"><a href="inferenza-sul-confronto-tra-le-medie-di-due-popolazioni-normali.html#campioni-indipendenti"><i class="fa fa-check"></i><b>4.3.1</b> Campioni indipendenti</a></li>
<li class="chapter" data-level="4.3.2" data-path="inferenza-sul-confronto-tra-le-medie-di-due-popolazioni-normali.html"><a href="inferenza-sul-confronto-tra-le-medie-di-due-popolazioni-normali.html#paired-ttest"><i class="fa fa-check"></i><b>4.3.2</b> Campioni dipendenti</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="inferenza-sullindice-di-correlazione-lineare.html"><a href="inferenza-sullindice-di-correlazione-lineare.html"><i class="fa fa-check"></i><b>4.4</b> Inferenza sull’indice di correlazione lineare</a></li>
<li class="chapter" data-level="4.5" data-path="test-sulla-bonta-di-adattamento-probabilita-completamente-specificate.html"><a href="test-sulla-bonta-di-adattamento-probabilita-completamente-specificate.html"><i class="fa fa-check"></i><b>4.5</b> Test sulla bontà di adattamento (probabilità completamente specificate)</a></li>
<li class="chapter" data-level="4.6" data-path="test-di-indipendenza-in-una-tabella-a-doppia-entrata.html"><a href="test-di-indipendenza-in-una-tabella-a-doppia-entrata.html"><i class="fa fa-check"></i><b>4.6</b> Test di indipendenza in una tabella a doppia entrata</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter5.html"><a href="chapter5.html"><i class="fa fa-check"></i><b>5</b> Il modello di regressione lineare</a><ul>
<li class="chapter" data-level="5.1" data-path="simple-reg.html"><a href="simple-reg.html"><i class="fa fa-check"></i><b>5.1</b> Il modello di regressione lineare semplice</a></li>
<li class="chapter" data-level="5.2" data-path="il-modello-di-regressione-lineare-multipla.html"><a href="il-modello-di-regressione-lineare-multipla.html"><i class="fa fa-check"></i><b>5.2</b> Il modello di regressione lineare multipla</a></li>
<li class="chapter" data-level="5.3" data-path="come-calcolare-le-previsioni-per-un-modello-di-regressione-lineare.html"><a href="come-calcolare-le-previsioni-per-un-modello-di-regressione-lineare.html"><i class="fa fa-check"></i><b>5.3</b> Come calcolare le previsioni per un modello di regressione lineare</a></li>
<li class="chapter" data-level="5.4" data-path="le-osservazioni-influenti.html"><a href="le-osservazioni-influenti.html"><i class="fa fa-check"></i><b>5.4</b> Le osservazioni influenti</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>6</b> Appendice</a><ul>
<li class="chapter" data-level="6.1" data-path="alcune-funzioni-di-r-per-la-statistica-descrittiva.html"><a href="alcune-funzioni-di-r-per-la-statistica-descrittiva.html"><i class="fa fa-check"></i><b>6.1</b> Alcune funzioni di <tt>R</tt> per la statistica descrittiva</a><ul>
<li class="chapter" data-level="6.1.1" data-path="alcune-funzioni-di-r-per-la-statistica-descrittiva.html"><a href="alcune-funzioni-di-r-per-la-statistica-descrittiva.html#analisi-descrittive-univariate-1"><i class="fa fa-check"></i><b>6.1.1</b> Analisi descrittive univariate</a></li>
<li class="chapter" data-level="6.1.2" data-path="alcune-funzioni-di-r-per-la-statistica-descrittiva.html"><a href="alcune-funzioni-di-r-per-la-statistica-descrittiva.html#analisi-descrittive-bivariate-1"><i class="fa fa-check"></i><b>6.1.2</b> Analisi descrittive bivariate</a></li>
<li class="chapter" data-level="6.1.3" data-path="alcune-funzioni-di-r-per-la-statistica-descrittiva.html"><a href="alcune-funzioni-di-r-per-la-statistica-descrittiva.html#ulteriori-rappresentazioni-grafiche"><i class="fa fa-check"></i><b>6.1.3</b> Ulteriori rappresentazioni grafiche</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="alcune-funzioni-r-per-la-statistica-inferenziale.html"><a href="alcune-funzioni-r-per-la-statistica-inferenziale.html"><i class="fa fa-check"></i><b>6.2</b> Alcune funzioni <tt>R</tt> per la statistica inferenziale</a><ul>
<li class="chapter" data-level="6.2.1" data-path="alcune-funzioni-r-per-la-statistica-inferenziale.html"><a href="alcune-funzioni-r-per-la-statistica-inferenziale.html#inferenza-sulla-media-di-una-popolazione-normale-1"><i class="fa fa-check"></i><b>6.2.1</b> Inferenza sulla media di una popolazione normale</a></li>
<li class="chapter" data-level="6.2.2" data-path="alcune-funzioni-r-per-la-statistica-inferenziale.html"><a href="alcune-funzioni-r-per-la-statistica-inferenziale.html#inferenza-sulla-proporzione-di-successi-in-una-popolazione-bernoulliana-1"><i class="fa fa-check"></i><b>6.2.2</b> Inferenza sulla proporzione di successi in una popolazione bernoulliana</a></li>
<li class="chapter" data-level="6.2.3" data-path="alcune-funzioni-r-per-la-statistica-inferenziale.html"><a href="alcune-funzioni-r-per-la-statistica-inferenziale.html#inferenza-sul-confronto-tra-le-medie-di-due-popolazioni-normali-1"><i class="fa fa-check"></i><b>6.2.3</b> Inferenza sul confronto tra le medie di due popolazioni normali</a></li>
<li class="chapter" data-level="6.2.4" data-path="alcune-funzioni-r-per-la-statistica-inferenziale.html"><a href="alcune-funzioni-r-per-la-statistica-inferenziale.html#inferenza-sullindice-di-correlazione-lineare-1"><i class="fa fa-check"></i><b>6.2.4</b> Inferenza sull’indice di correlazione lineare</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Pubblicato con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><strong>Elementi di <tt>R</tt> e <tt>Radiant</tt> per un primo corso di Statistica</strong></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simple-reg" class="section level2">
<h2><span class="header-section-number">5.1</span> Il modello di regressione lineare semplice</h2>
<p>Come sappiamo, il modello di regressione lineare semplice è definito come</p>
<span class="math display" id="eq:linreg-simple">\[\begin{equation}
Y_i = \beta_0 + \beta_1 x_i + \varepsilon_i, \quad i=1,\ldots,n,
\tag{5.1}
\end{equation}\]</span>
<p>dove <span class="math inline">\((x_i, y_i)\)</span> rappresentano le coppie di osservazioni facenti parte del campione, <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span> sono i coefficienti non noti che si suppone leghino le variabili <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> nella popolazione, mentre <span class="math inline">\(\varepsilon_i\)</span> corrisponde all’errore casuale che intuitivamente descrive l’informazione relativa a <span class="math inline">\(Y\)</span> che non è possibile spiegare attraverso una funzione lineare di <span class="math inline">\(X\)</span>. In aggiunta all’equazione <a href="simple-reg.html#eq:linreg-simple">(5.1)</a>, il modello di regressione lineare semplice è definito anche dalle seguenti ipotesi:</p>
<ol style="list-style-type: decimal">
<li>le osservazioni <span class="math inline">\(x_i\)</span> sono costanti o realizzazioni di una variabile aleatoria <span class="math inline">\(X\)</span> non correlata con le componenti aleatorie di errore, <span class="math inline">\(\varepsilon_i\)</span>. In quest’ultimo caso l’inferenza è svolta condizionatamente ai valori osservati di <span class="math inline">\(X\)</span></li>
<li>gli errori aleatori, <span class="math inline">\(\varepsilon_i\)</span>, sono variabili aleatorie con media 0 e varianza <span class="math inline">\(\sigma^2\)</span> costante per ogni <span class="math inline">\(i = 1,\ldots,n\)</span> (omoschedasticità)</li>
<li>gli errori aleatori, <span class="math inline">\(\varepsilon_i\)</span>, non sono correlati tra loro</li>
<li>gli errori aleatori, <span class="math inline">\(\varepsilon_i\)</span>, sono distribuiti secondo una distribuzione normale</li>
</ol>
<p>La funzione principale per stimare un modello di regressione lineare in <tt>R</tt> è <tt>lm()</tt>, che sta per <em>linear model</em>. Il primo argomento di questa funzione è un tipo di oggetto che non abbiamo mai usato finora chiamato <em>formula</em>. Gli oggetti di tipo formula sono impiegati in <tt>R</tt> per specificare una relazione tra una variabile dipendente <tt>y</tt> e una (o più) variabili indipendenti <tt>x</tt>. Per specificare un oggetto di tipo formula è necessario utilizzare un simbolo particolare che non è sempre facile recuperare sulle tastiere italiane, ovvero il simbolo di tilde “<tt><span class="math inline">\(\sim\)</span></tt>”<a href="#fn41" class="footnoteRef" id="fnref41"><sup>41</sup></a>. La particolare combinazione di tasti che è necessario usare per ottenere tale simbolo dipende dal sistema operativo (Mac, Windows, ecc.), dal tipo di macchina che state usando (laptop, desktop, ecc.), oltre che dal particolare brand della vostra macchina. Per questo motivo, non è possibile indicare qui in modo univoco come ottenere la tilde sul vostro particolare computer, ma vi suggeriamo un modo poco elegante, ma molto semplice, per recuperarlo: eseguite il codice <tt>?tilde</tt>, copiate il carattere di tilde che trovate nella pagina di help e incollatelo dove vi serve<a href="#fn42" class="footnoteRef" id="fnref42"><sup>42</sup></a>.</p>
<p>La sintassi generale della funzione <tt>lm()</tt> è</p>
<center>
<tt>lm(y ~ x)</tt>,
</center>
<p>la quale restituisce una lista (si veda la Sezione <a href="le-principali-strutture-di-dati-disponibili-in-r.html#lists">1.3.6</a>) contenente un gran numero di risultati relativi alla stima del modello considerato. A titolo d’esempio, consideriamo il data frame <tt>comp</tt> disponibile nel file <tt>competitors.RData</tt>. Il data frame <tt>comp</tt> contiene i valori rilevati in 113 settimane successive per le seguenti variabili relative a un’azienda che produce un prodotto destinato al consumo alimentare:</p>
<ul>
<li><tt>mktshare</tt> indica la quota di mercato (in termini relativi) dell’azienda rilevata alla fine di ogni settimana</li>
<li><tt>ownprice</tt> indica il prezzo (in $) alla fine di ogni settimana del prodotto offerto dall’azienda in questione</li>
<li><tt>comp1price</tt> indica il prezzo (in $) alla fine di ogni settimana del medesimo prodotto offerto da un competitor dell’azienda</li>
<li><tt>comp2price</tt> indica il prezzo (in $) alla fine di ogni settimana del medesimo prodotto offerto da un secondo competitor dell’azienda</li>
</ul>
<p>Vogliamo stimare la relazione lineare che intercorre tra la quota di mercato dell’azienda nelle varie settimane e il prezzo del proprio prodotto nelle medesime settimane, ovvero ci interessa stimare il modello</p>
<span class="math display" id="eq:linreg-simple-comp">\[\begin{equation}
\mbox{mktshare}_i = \beta_0 + \beta_1 \mbox{ownprice}_i + \varepsilon_i.
\tag{5.2}
\end{equation}\]</span>
<p>Dopo aver caricato il file dei dati (vedi la Sezione <a href="file-loading.html#file-loading">1.8</a>), si può utilizzare la funzione <tt>View()</tt> per vederli. Il codice seguente utilizza la funzione <tt>lm()</tt> per stimare il modello, i cui risultati sono memorizzati nell’oggetto <tt>comp_m1</tt>, di cui si può ottenere una sintesi attraverso la funzione <tt>summary()</tt>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">load</span>(<span class="st">&quot;competitors.RData&quot;</span>)
<span class="op">&gt;</span><span class="st"> </span>comp_m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(mktshare <span class="op">~</span><span class="st"> </span>ownprice, <span class="dt">data =</span> comp)
<span class="op">&gt;</span><span class="st"> </span><span class="kw">summary</span>(comp_m1)</code></pre></div>
<pre><code>
Call:
lm(formula = mktshare ~ ownprice, data = comp)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.01715 -0.00961 -0.00310  0.00642  0.05011 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.11043    0.01498    7.37  3.2e-11 ***
ownprice    -0.04532    0.00896   -5.06  1.7e-06 ***
---
Signif. codes:  
0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.0129 on 111 degrees of freedom
Multiple R-squared:  0.187, Adjusted R-squared:  0.18 
F-statistic: 25.6 on 1 and 111 DF,  p-value: 1.67e-06</code></pre>
<p>Vi facciamo notare che oltre all’argomento di tipo formula <tt>mktshare <span class="math inline">\(\sim\)</span> ownprice</tt>, che specifica il modello da stimare, nella funzione <tt>lm()</tt> abbiamo aggiunto anche un secondo argomento, denominato <tt>data</tt>. Questo argomento serve per indicare ad <tt>R</tt> il data frame in cui si trovano le variabili specificate nella formula<a href="#fn43" class="footnoteRef" id="fnref43"><sup>43</sup></a>.</p>
<p>La funzione <tt>summary()</tt>, applicata alla lista restituita dalla funzione <tt>lm()</tt><!-- ^[Notate che avevamo già usato la funzione <tt>s</tt>mmary()} nella Sezione \@ref(summary_stats), ma in quel caso era applicata ad un vettore numerico, del quale restituiva una serie di statistiche di sintesi. Funzioni di questo tipo, che cioè si comportano in modo deiverso a seconda del tipo di oggetti a cui vengono applicate, vengono chiamate *generiche*.] -->, produce un output che consiste delle seguenti parti:</p>
<ul>
<li>la prima riga dell’output (<tt>Call</tt>) riporta il codice che è stato eseguito</li>
<li>la seconda parte dell’output (<tt>Residuals</tt>) offre una sintesi dei residui del modello</li>
<li>la terza parte (<tt>Coefficients</tt>) fornisce le stime dei coefficienti del modello insieme ai relativi p-value. Per l’esempio precedente, il modello stimato è quindi dato da</li>
</ul>
<span class="math display" id="eq:linreg-simple-comp-fit">\[\begin{equation}
\widehat{\mbox{mktshare}}_i = 0.1104 -0.0453 \, \mbox{ownprice}_i.
\tag{5.3}
\end{equation}\]</span>
<ul>
<li>la quarta e ultima parte (ultime tre righe) contiene alcuni indici utili per valutare la bontà complessiva del modello, in particolare la stima di <span class="math inline">\(\sigma\)</span> (indicata come <tt>Residual standard error</tt>), l’indice <span class="math inline">\(R^2\)</span> (riportato come <tt>Multiple R-squared</tt>), e il test <span class="math inline">\(F\)</span> (ultima riga dell’output)</li>
</ul>
<p>L’indice <span class="math inline">\(R^2\)</span> (<tt>0.1874</tt>) indica una limitata capacità predittiva del modello, anche se il basso p-value del coefficiente <span class="math inline">\(\beta_1\)</span> (<tt>1.67e-06</tt>) segnala che l’associazione lineare tra le due variabili è significativa da un punto di vista statistico.</p>
<p>E’ possibile visualizzare la retta stimata direttamente sul diagramma di dispersione delle due variabili attraverso il seguente codice<a href="#fn44" class="footnoteRef" id="fnref44"><sup>44</sup></a>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(mktshare <span class="op">~</span><span class="st"> </span>ownprice, <span class="dt">data =</span> comp)
<span class="op">&gt;</span><span class="st"> </span><span class="kw">abline</span>(comp_m1, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:lm-fitted-line"></span>
<img src="manuale_R_files/figure-html/lm-fitted-line-1.pdf" alt="Diagramma di dispersione di &lt;tt&gt;mktshare&lt;/tt&gt; contro &lt;tt&gt;ownprice&lt;/tt&gt; e relativa retta stimata." width="480" />
<p class="caption">
Figura 5.1: Diagramma di dispersione di <tt>mktshare</tt> contro <tt>ownprice</tt> e relativa retta stimata.
</p>
</div>
<p>La prima linea di codice usa la funzione <tt>plot()</tt>, ma a differenza di quanto abbiamo visto in precedenza, in questo caso abbiamo indicato le variabili da rappresentare nel grafico attraverso una formula. La seconda linea di codice utilizza invece la funzione <tt>abline()</tt>, la quale aggiunge al grafico attivo una linea, in questo caso la retta stimata.</p>
<p>L’output fornito da <tt>R</tt> per un modello di regressione lineare include i p-value per i test sui due coefficienti, ma non include i rispettivi intervalli di confidenza. Per ottenere questi ultimi è necessario utilizzare la funzione <tt>confint()</tt> direttamente sul risultato di <tt>lm()</tt>. Per il precedente esempio otteniamo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">confint</span>(comp_m1)</code></pre></div>
<pre><code>               2.5 %   97.5 %
(Intercept)  0.08074  0.14012
ownprice    -0.06307 -0.02757</code></pre>
<p>Altre funzioni utili per esaminare i risultati della stima di un modello di regressione lineare (non solo semplice) sono:</p>
<ul>
<li><tt>coef()</tt>, che stampa le stime dei coefficienti</li>
<li><tt>residuals()</tt>, che calcola i residui del modello</li>
<li><tt>fitted()</tt>, che calcola i valori previsti dal modello per le sole osservazioni incluse nel campione</li>
<li><tt>anova()</tt>, che produce la scomposizione della devianza</li>
<li><tt>predict()</tt>, che consente di calcolare le previsioni in modo più generale</li>
</ul>
<p>Tralasciando per il momento <tt>predict()</tt>, alla quale dedicheremo una sezione successiva del capitolo, vediamo ora il tipo di output prodotto dalle altre:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">coef</span>(comp_m1)</code></pre></div>
<pre><code>(Intercept)    ownprice 
    0.11043    -0.04532 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">anova</span>(comp_m1)</code></pre></div>
<pre><code>Analysis of Variance Table

Response: mktshare
           Df  Sum Sq Mean Sq F value  Pr(&gt;F)    
ownprice    1 0.00428 0.00428    25.6 1.7e-06 ***
Residuals 111 0.01855 0.00017                    
---
Signif. codes:  
0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Il seguente codice salva in due nuovi vettori i valori previsti dal modello per le osservazioni incluse nel campione e i relativi residui, che ricordiamo sono definiti come le differenze tra i valori osservati e quelli previsti. Queste quantità possono essere rappresentate in un grafico, chiamato grafico dei residui, che rappresenta uno strumento fondamentale per valutare la bontà del modello (ovvero delle ipotesi teoriche riguardanti gli errori):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>comp_m1_fitted &lt;-<span class="st"> </span><span class="kw">fitted</span>(comp_m1)
<span class="op">&gt;</span><span class="st"> </span>comp_m1_resid &lt;-<span class="st"> </span><span class="kw">residuals</span>(comp_m1)
<span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(comp_m1_fitted, comp_m1_resid, <span class="dt">xlab =</span> <span class="st">&quot;Valori previsti&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Residui&quot;</span>)
<span class="op">&gt;</span><span class="st"> </span><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:lm-res-fit"></span>
<img src="manuale_R_files/figure-html/lm-res-fit-1.pdf" alt="Grafico dei residui contro i valori previsti per il modello &lt;tt&gt;comp_m1&lt;/tt&gt;." width="480" />
<p class="caption">
Figura 5.2: Grafico dei residui contro i valori previsti per il modello <tt>comp_m1</tt>.
</p>
</div>
<p>Le opzioni <tt>h</tt> e <tt>lty</tt> nel codice precedente servono rispettivamente a disegnare una linea orizzontale (in corrispondenza del valore 0 sull’asse verticale) e a scegliere il tipo di linea (il valore 2 indica una linea tratteggiata).</p>
</div>
<div class="footnotes">
<hr />
<ol start="41">
<li id="fn41"><p>Si usa il simbolo di tilde perché <tt>R</tt> è un software nato e sviluppato nei paesi anglosassoni e sulle tastiere US e UK tale simbolo è direttamente disponibile su uno dei tasti.<a href="simple-reg.html#fnref41">↩</a></p></li>
<li id="fn42"><p>In generale, sui computer Mac dovreste poter recuperare il simbolo di tilde con la combinazione di tasti alt+5, ovvero il tasto option solitamente situato a sinistra della barra spaziatrice insieme al numero 5. Sulla maggior parte dei computer desktop (ma non laptop) con sistema operativo Windows, la tilde si riesce a recuperare con la combinazione di tasti Alt+126, ovvero il tasto Alt (di solito situato a sinsitra della barra spaziatrice) insieme al numero 126. Il numero 126 deve essere digitato sul tastierino numerico della tastiera (ovvero non dovete usare i numeri posti sopra la parte centrale della tastiera). Purtroppo, sui laptop la posizione di questo simbolo dipende dalla tastiera e dal brand del laptop stesso, per cui vi invitiamo a consultare le istruzioni del vostro laptop.<a href="simple-reg.html#fnref42">↩</a></p></li>
<li id="fn43"><p>Ciò è necessario perché le variabili di un data frame non sono disponibili come oggetti autonomi nella memoria di <tt>R</tt>, a meno che non abbiate prima usato <tt>attach()</tt>.<a href="simple-reg.html#fnref43">↩</a></p></li>
<li id="fn44"><p>L’opzione <tt>lwd</tt> consente di scegliere lo spessore della linea, mentre <tt>col</tt> permette di scegliere il colore.<a href="simple-reg.html#fnref44">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter5.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="il-modello-di-regressione-lineare-multipla.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
